<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.42.4 (0)
 -->
<!-- Title: NonResidentKey Pages: 1 -->
<svg width="544pt" height="459pt"
 viewBox="0.00 0.00 543.70 459.48" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 455.48)">
<title>NonResidentKey</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-455.48 539.7,-455.48 539.7,4 -4,4"/>
<text text-anchor="middle" x="267.85" y="-436.28" font-family="Times,serif" font-size="14.00">generating a</text>
<text text-anchor="middle" x="267.85" y="-421.28" font-family="Times,serif" font-size="14.00">Non&#45;Resident Key /</text>
<text text-anchor="middle" x="267.85" y="-406.28" font-family="Times,serif" font-size="14.00">Non&#45;Discoverable Credential</text>
<g id="clust1" class="cluster">
<title>cluster_authenticator</title>
<path fill="#ffc0c0" stroke="black" d="M20,-153.74C20,-153.74 439,-153.74 439,-153.74 445,-153.74 451,-159.74 451,-165.74 451,-165.74 451,-378.48 451,-378.48 451,-384.48 445,-390.48 439,-390.48 439,-390.48 20,-390.48 20,-390.48 14,-390.48 8,-384.48 8,-378.48 8,-378.48 8,-165.74 8,-165.74 8,-159.74 14,-153.74 20,-153.74"/>
<text text-anchor="middle" x="229.5" y="-375.28" font-family="Times,serif" font-size="14.00">Authenticator</text>
</g>
<!-- MasterKey -->
<g id="node1" class="node">
<title>MasterKey</title>
<ellipse fill="none" stroke="black" cx="113" cy="-341.48" rx="96.68" ry="18"/>
<text text-anchor="middle" x="113" y="-337.78" font-family="Times,serif" font-size="14.00">Master Secret Key</text>
</g>
<!-- KDF -->
<g id="node2" class="node">
<title>KDF</title>
<polygon fill="#ffffff" stroke="black" points="377,-287.48 187,-287.48 187,-251.48 377,-251.48 377,-287.48"/>
<text text-anchor="middle" x="282" y="-265.78" font-family="Times,serif" font-size="14.00">Key Derivation Function</text>
</g>
<!-- MasterKey&#45;&gt;KDF -->
<g id="edge1" class="edge">
<title>MasterKey&#45;&gt;KDF</title>
<path fill="none" stroke="black" d="M145.99,-324.42C168.57,-314.61 198.98,-301.95 225.35,-291.36"/>
<polygon fill="black" stroke="black" points="226.87,-294.52 234.86,-287.56 224.28,-288.02 226.87,-294.52"/>
</g>
<!-- MasterKey&#45;&gt;KDF -->
<g id="edge17" class="edge">
<title>MasterKey&#45;&gt;KDF</title>
<path fill="none" stroke="#ffe0e0" d="M155.35,-325.29C180.4,-315.41 212.01,-302.4 237.43,-291.53"/>
<polygon fill="#ffe0e0" stroke="#ffe0e0" points="239.04,-294.65 246.84,-287.48 236.27,-288.22 239.04,-294.65"/>
</g>
<!-- crypt -->
<g id="node4" class="node">
<title>crypt</title>
<polygon fill="#ffffff" stroke="black" points="151,-207.61 75,-207.61 75,-169.61 151,-169.61 151,-207.61"/>
<text text-anchor="middle" x="113" y="-192.41" font-family="Times,serif" font-size="14.00">encrypt/</text>
<text text-anchor="middle" x="113" y="-177.41" font-family="Times,serif" font-size="14.00">decrypt</text>
</g>
<!-- MasterKey&#45;&gt;crypt -->
<g id="edge5" class="edge">
<title>MasterKey&#45;&gt;crypt</title>
<path fill="none" stroke="black" d="M108.54,-323.47C105.84,-297.82 105.53,-248.97 107.59,-217.91"/>
<polygon fill="black" stroke="black" points="111.1,-217.98 108.42,-207.73 104.12,-217.41 111.1,-217.98"/>
</g>
<!-- MasterKey&#45;&gt;crypt -->
<g id="edge18" class="edge">
<title>MasterKey&#45;&gt;crypt</title>
<path fill="none" stroke="#ffe0e0" d="M117.46,-323.47C120.16,-297.82 120.47,-248.97 118.41,-217.91"/>
<polygon fill="#ffe0e0" stroke="#ffe0e0" points="121.88,-217.41 117.58,-207.73 114.9,-217.98 121.88,-217.41"/>
</g>
<!-- KDF&#45;&gt;crypt -->
<g id="edge6" class="edge">
<title>KDF&#45;&gt;crypt</title>
<path fill="none" stroke="black" d="M239.65,-251.37C213.77,-239.87 180.87,-224.59 155.05,-212.11"/>
<polygon fill="black" stroke="black" points="156.4,-208.88 145.88,-207.65 153.34,-215.17 156.4,-208.88"/>
</g>
<!-- PrivKey -->
<g id="node5" class="node">
<title>PrivKey</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="282" cy="-188.61" rx="72.66" ry="26.74"/>
<text text-anchor="middle" x="282" y="-192.41" font-family="Times,serif" font-size="14.00">(ephemeral)</text>
<text text-anchor="middle" x="282" y="-177.41" font-family="Times,serif" font-size="14.00">private key</text>
</g>
<!-- KDF&#45;&gt;PrivKey -->
<g id="edge4" class="edge">
<title>KDF&#45;&gt;PrivKey</title>
<path fill="none" stroke="black" d="M276.32,-251.37C275.5,-243.73 275.15,-234.43 275.28,-225.38"/>
<polygon fill="black" stroke="black" points="278.77,-225.5 275.62,-215.39 271.78,-225.26 278.77,-225.5"/>
</g>
<!-- KDF&#45;&gt;PrivKey -->
<g id="edge19" class="edge">
<title>KDF&#45;&gt;PrivKey</title>
<path fill="none" stroke="#ffe0e0" d="M287.68,-251.37C288.5,-243.73 288.85,-234.43 288.72,-225.38"/>
<polygon fill="#ffe0e0" stroke="#ffe0e0" points="292.22,-225.26 288.38,-215.39 285.23,-225.5 292.22,-225.26"/>
</g>
<!-- RNG -->
<g id="node3" class="node">
<title>RNG</title>
<polygon fill="#ffffff" stroke="black" points="442.5,-359.48 227.5,-359.48 227.5,-323.48 442.5,-323.48 442.5,-359.48"/>
<text text-anchor="middle" x="335" y="-337.78" font-family="Times,serif" font-size="14.00">Random Number Generator</text>
</g>
<!-- RNG&#45;&gt;KDF -->
<g id="edge2" class="edge">
<title>RNG&#45;&gt;KDF</title>
<path fill="none" stroke="black" d="M321.9,-323.18C315.61,-314.87 307.95,-304.76 301.04,-295.62"/>
<polygon fill="black" stroke="black" points="303.78,-293.44 294.95,-287.58 298.2,-297.67 303.78,-293.44"/>
</g>
<!-- crypt&#45;&gt;KDF -->
<g id="edge15" class="edge">
<title>crypt&#45;&gt;KDF</title>
<path fill="none" stroke="#ffe0e0" d="M151.06,-204.82C178.08,-216.75 214.16,-233.49 241.67,-246.81"/>
<polygon fill="#ffe0e0" stroke="#ffe0e0" points="240.49,-250.13 251.01,-251.37 243.55,-243.84 240.49,-250.13"/>
</g>
<!-- Cred_ID -->
<g id="node7" class="node">
<title>Cred_ID</title>
<ellipse fill="none" stroke="black" cx="93" cy="-98.87" rx="73.39" ry="18"/>
<text text-anchor="middle" x="93" y="-95.17" font-family="Times,serif" font-size="14.00">Credential ID</text>
</g>
<!-- crypt&#45;&gt;Cred_ID -->
<g id="edge7" class="edge">
<title>crypt&#45;&gt;Cred_ID</title>
<path fill="none" stroke="black" d="M103.26,-169.43C99.22,-157.19 95.26,-140.83 92.9,-127.05"/>
<polygon fill="black" stroke="black" points="96.36,-126.51 91.44,-117.13 89.43,-127.53 96.36,-126.51"/>
</g>
<!-- PubKey -->
<g id="node9" class="node">
<title>PubKey</title>
<ellipse fill="none" stroke="black" cx="303" cy="-98.87" rx="118.17" ry="26.74"/>
<text text-anchor="middle" x="303" y="-102.67" font-family="Times,serif" font-size="14.00">public key</text>
<text text-anchor="middle" x="303" y="-87.67" font-family="Times,serif" font-size="14.00">of the ephemeral key</text>
</g>
<!-- PrivKey&#45;&gt;PubKey -->
<g id="edge8" class="edge">
<title>PrivKey&#45;&gt;PubKey</title>
<path fill="none" stroke="black" d="M288.19,-161.76C290.13,-153.62 292.32,-144.48 294.41,-135.77"/>
<polygon fill="black" stroke="black" points="297.86,-136.38 296.78,-125.84 291.05,-134.75 297.86,-136.38"/>
</g>
<!-- RP_ID -->
<g id="node6" class="node">
<title>RP_ID</title>
<ellipse fill="none" stroke="black" cx="498" cy="-341.48" rx="37.89" ry="18"/>
<text text-anchor="middle" x="498" y="-337.78" font-family="Times,serif" font-size="14.00">RP ID</text>
</g>
<!-- RP_ID&#45;&gt;KDF -->
<g id="edge3" class="edge">
<title>RP_ID&#45;&gt;KDF</title>
<path fill="none" stroke="black" d="M466.73,-331.14C459.83,-328.55 452.67,-325.82 446,-323.48 412.43,-311.72 374.7,-299.99 343.85,-290.57"/>
<polygon fill="black" stroke="black" points="344.67,-287.17 334.09,-287.6 342.63,-293.86 344.67,-287.17"/>
</g>
<!-- RP_ID&#45;&gt;KDF -->
<g id="edge16" class="edge">
<title>RP_ID&#45;&gt;KDF</title>
<path fill="none" stroke="#ffe0e0" d="M474.19,-327.22C470.79,-325.92 467.33,-324.65 464,-323.48 430.28,-311.67 392.38,-299.89 359.87,-290.45"/>
<polygon fill="#ffe0e0" stroke="#ffe0e0" points="360.55,-287 349.97,-287.6 358.61,-293.73 360.55,-287"/>
</g>
<!-- Cred_ID&#45;&gt;crypt -->
<g id="edge14" class="edge">
<title>Cred_ID&#45;&gt;crypt</title>
<path fill="none" stroke="#ffe0e0" d="M102.33,-116.84C106.41,-128.87 110.45,-145.31 112.91,-159.31"/>
<polygon fill="#ffe0e0" stroke="#ffe0e0" points="109.48,-160.07 114.45,-169.43 116.4,-159.02 109.48,-160.07"/>
</g>
<!-- RP_DB -->
<g id="node10" class="node">
<title>RP_DB</title>
<path fill="none" stroke="black" d="M357,-32.73C357,-34.53 332.8,-36 303,-36 273.2,-36 249,-34.53 249,-32.73 249,-32.73 249,-3.27 249,-3.27 249,-1.47 273.2,0 303,0 332.8,0 357,-1.47 357,-3.27 357,-3.27 357,-32.73 357,-32.73"/>
<path fill="none" stroke="black" d="M357,-32.73C357,-30.92 332.8,-29.45 303,-29.45 273.2,-29.45 249,-30.92 249,-32.73"/>
<text text-anchor="middle" x="303" y="-14.3" font-family="Times,serif" font-size="14.00">RP Database</text>
</g>
<!-- Cred_ID&#45;&gt;RP_DB -->
<g id="edge9" class="edge">
<title>Cred_ID&#45;&gt;RP_DB</title>
<path fill="none" stroke="black" d="M127.56,-82.85C159.52,-70.25 207.48,-52.18 245.23,-38.47"/>
<polygon fill="black" stroke="black" points="246.87,-41.6 255.09,-34.91 244.5,-35.02 246.87,-41.6"/>
</g>
<!-- User_ID -->
<g id="node8" class="node">
<title>User_ID</title>
<ellipse fill="none" stroke="black" cx="486" cy="-98.87" rx="46.59" ry="18"/>
<text text-anchor="middle" x="486" y="-95.17" font-family="Times,serif" font-size="14.00">User ID</text>
</g>
<!-- User_ID&#45;&gt;RP_DB -->
<g id="edge10" class="edge">
<title>User_ID&#45;&gt;RP_DB</title>
<path fill="none" stroke="black" d="M452.6,-86.08C442.35,-81.59 431.2,-76.48 421,-72 396.12,-61.07 368.28,-49.38 345.8,-39.78"/>
<polygon fill="black" stroke="black" points="347.1,-36.52 336.53,-35.8 344.34,-42.96 347.1,-36.52"/>
</g>
<!-- User_ID&#45;&gt;RP_DB -->
<g id="edge12" class="edge">
<title>User_ID&#45;&gt;RP_DB</title>
<path fill="none" stroke="#ffe0e0" d="M463.12,-83.02C455.46,-79.36 446.94,-75.49 439,-72 413.22,-60.67 384.26,-48.54 359.64,-38.75"/>
<polygon fill="#ffe0e0" stroke="#ffe0e0" points="360.66,-35.39 350.08,-34.98 358.09,-41.9 360.66,-35.39"/>
</g>
<!-- PubKey&#45;&gt;RP_DB -->
<g id="edge11" class="edge">
<title>PubKey&#45;&gt;RP_DB</title>
<path fill="none" stroke="black" d="M303,-71.61C303,-63.51 303,-54.57 303,-46.39"/>
<polygon fill="black" stroke="black" points="306.5,-46.22 303,-36.22 299.5,-46.22 306.5,-46.22"/>
</g>
<!-- RP_DB&#45;&gt;Cred_ID -->
<g id="edge13" class="edge">
<title>RP_DB&#45;&gt;Cred_ID</title>
<path fill="none" stroke="#ffe0e0" d="M264.55,-35.55C230.88,-48.75 181.83,-67.19 144.74,-80.58"/>
<polygon fill="#ffe0e0" stroke="#ffe0e0" points="143.33,-77.37 135.1,-84.04 145.69,-83.95 143.33,-77.37"/>
</g>
</g>
</svg>
