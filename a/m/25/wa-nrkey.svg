<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.42.4 (0)
 -->
<!-- Title: NonResidentKey Pages: 1 -->
<svg width="544pt" height="459pt"
 viewBox="0.00 0.00 543.70 459.48" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 455.48)">
<title>NonResidentKey</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-455.48 539.7,-455.48 539.7,4 -4,4"/>
<text text-anchor="middle" x="267.85" y="-436.28" font-family="Times,serif" font-size="14.00">generating a</text>
<text text-anchor="middle" x="267.85" y="-421.28" font-family="Times,serif" font-size="14.00">Non&#45;Resident Key /</text>
<text text-anchor="middle" x="267.85" y="-406.28" font-family="Times,serif" font-size="14.00">Non&#45;Discoverable Credential</text>
<g id="clust1" class="cluster">
<title>cluster_authenticator</title>
<path fill="#ffc0c0" stroke="black" d="M20,-153.74C20,-153.74 439,-153.74 439,-153.74 445,-153.74 451,-159.74 451,-165.74 451,-165.74 451,-378.48 451,-378.48 451,-384.48 445,-390.48 439,-390.48 439,-390.48 20,-390.48 20,-390.48 14,-390.48 8,-384.48 8,-378.48 8,-378.48 8,-165.74 8,-165.74 8,-159.74 14,-153.74 20,-153.74"/>
<text text-anchor="middle" x="229.5" y="-375.28" font-family="Times,serif" font-size="14.00">Authenticator</text>
</g>
<!-- MasterKey -->
<g id="node1" class="node">
<title>MasterKey</title>
<ellipse fill="none" stroke="black" cx="113" cy="-341.48" rx="96.68" ry="18"/>
<text text-anchor="middle" x="113" y="-337.78" font-family="Times,serif" font-size="14.00">Master Secret Key</text>
</g>
<!-- KDF -->
<g id="node2" class="node">
<title>KDF</title>
<polygon fill="#ffffff" stroke="black" points="380,-287.48 190,-287.48 190,-251.48 380,-251.48 380,-287.48"/>
<text text-anchor="middle" x="285" y="-265.78" font-family="Times,serif" font-size="14.00">Key Derivation Function</text>
</g>
<!-- MasterKey&#45;&gt;KDF -->
<g id="edge1" class="edge">
<title>MasterKey&#45;&gt;KDF</title>
<path fill="none" stroke="black" d="M146.68,-324.42C169.78,-314.56 200.9,-301.84 227.81,-291.22"/>
<polygon fill="black" stroke="black" points="229.1,-294.48 237.13,-287.56 226.54,-287.96 229.1,-294.48"/>
</g>
<!-- MasterKey&#45;&gt;KDF -->
<g id="edge17" class="edge">
<title>MasterKey&#45;&gt;KDF</title>
<path fill="none" stroke="#ffe0e0" d="M156,-325.29C181.58,-315.37 213.92,-302.29 239.87,-291.39"/>
<polygon fill="#ffe0e0" stroke="#ffe0e0" points="241.26,-294.6 249.11,-287.48 238.54,-288.15 241.26,-294.6"/>
</g>
<!-- crypt -->
<g id="node4" class="node">
<title>crypt</title>
<polygon fill="#ffffff" stroke="black" points="157.5,-207.61 68.5,-207.61 68.5,-169.61 157.5,-169.61 157.5,-207.61"/>
<text text-anchor="middle" x="113" y="-192.41" font-family="Times,serif" font-size="14.00">&quot;encrypt&quot;/</text>
<text text-anchor="middle" x="113" y="-177.41" font-family="Times,serif" font-size="14.00">&quot;decrypt&quot;</text>
</g>
<!-- MasterKey&#45;&gt;crypt -->
<g id="edge5" class="edge">
<title>MasterKey&#45;&gt;crypt</title>
<path fill="none" stroke="black" d="M108.54,-323.47C105.84,-297.82 105.53,-248.97 107.59,-217.91"/>
<polygon fill="black" stroke="black" points="111.1,-217.98 108.42,-207.73 104.12,-217.41 111.1,-217.98"/>
</g>
<!-- MasterKey&#45;&gt;crypt -->
<g id="edge18" class="edge">
<title>MasterKey&#45;&gt;crypt</title>
<path fill="none" stroke="#ffe0e0" d="M117.46,-323.47C120.16,-297.82 120.47,-248.97 118.41,-217.91"/>
<polygon fill="#ffe0e0" stroke="#ffe0e0" points="121.88,-217.41 117.58,-207.73 114.9,-217.98 121.88,-217.41"/>
</g>
<!-- KDF&#45;&gt;crypt -->
<g id="edge6" class="edge">
<title>KDF&#45;&gt;crypt</title>
<path fill="none" stroke="black" d="M242,-251.37C215.68,-239.87 182.2,-224.59 155.9,-212.11"/>
<polygon fill="black" stroke="black" points="157.1,-208.8 146.57,-207.65 154.08,-215.12 157.1,-208.8"/>
</g>
<!-- PrivKey -->
<g id="node5" class="node">
<title>PrivKey</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="285" cy="-188.61" rx="72.66" ry="26.74"/>
<text text-anchor="middle" x="285" y="-192.41" font-family="Times,serif" font-size="14.00">(ephemeral)</text>
<text text-anchor="middle" x="285" y="-177.41" font-family="Times,serif" font-size="14.00">private key</text>
</g>
<!-- KDF&#45;&gt;PrivKey -->
<g id="edge4" class="edge">
<title>KDF&#45;&gt;PrivKey</title>
<path fill="none" stroke="black" d="M279.32,-251.37C278.5,-243.73 278.15,-234.43 278.28,-225.38"/>
<polygon fill="black" stroke="black" points="281.77,-225.5 278.62,-215.39 274.78,-225.26 281.77,-225.5"/>
</g>
<!-- KDF&#45;&gt;PrivKey -->
<g id="edge19" class="edge">
<title>KDF&#45;&gt;PrivKey</title>
<path fill="none" stroke="#ffe0e0" d="M290.68,-251.37C291.5,-243.73 291.85,-234.43 291.72,-225.38"/>
<polygon fill="#ffe0e0" stroke="#ffe0e0" points="295.22,-225.26 291.38,-215.39 288.23,-225.5 295.22,-225.26"/>
</g>
<!-- RNG -->
<g id="node3" class="node">
<title>RNG</title>
<polygon fill="#ffffff" stroke="black" points="442.5,-359.48 227.5,-359.48 227.5,-323.48 442.5,-323.48 442.5,-359.48"/>
<text text-anchor="middle" x="335" y="-337.78" font-family="Times,serif" font-size="14.00">Random Number Generator</text>
</g>
<!-- RNG&#45;&gt;KDF -->
<g id="edge2" class="edge">
<title>RNG&#45;&gt;KDF</title>
<path fill="none" stroke="black" d="M322.64,-323.18C316.77,-314.95 309.63,-304.96 303.16,-295.9"/>
<polygon fill="black" stroke="black" points="305.88,-293.69 297.22,-287.58 300.18,-297.76 305.88,-293.69"/>
</g>
<!-- crypt&#45;&gt;KDF -->
<g id="edge15" class="edge">
<title>crypt&#45;&gt;KDF</title>
<path fill="none" stroke="#ffe0e0" d="M157.8,-207.51C184.53,-219.22 218.14,-234.58 244.15,-246.96"/>
<polygon fill="#ffe0e0" stroke="#ffe0e0" points="242.83,-250.2 253.36,-251.37 245.85,-243.89 242.83,-250.2"/>
</g>
<!-- Cred_ID -->
<g id="node7" class="node">
<title>Cred_ID</title>
<ellipse fill="none" stroke="black" cx="94" cy="-98.87" rx="73.39" ry="18"/>
<text text-anchor="middle" x="94" y="-95.17" font-family="Times,serif" font-size="14.00">Credential ID</text>
</g>
<!-- crypt&#45;&gt;Cred_ID -->
<g id="edge7" class="edge">
<title>crypt&#45;&gt;Cred_ID</title>
<path fill="none" stroke="black" d="M103.47,-169.43C99.57,-157.19 95.79,-140.83 93.59,-127.05"/>
<polygon fill="black" stroke="black" points="97.06,-126.57 92.24,-117.13 90.12,-127.51 97.06,-126.57"/>
</g>
<!-- PubKey -->
<g id="node9" class="node">
<title>PubKey</title>
<ellipse fill="none" stroke="black" cx="304" cy="-98.87" rx="118.17" ry="26.74"/>
<text text-anchor="middle" x="304" y="-102.67" font-family="Times,serif" font-size="14.00">public key</text>
<text text-anchor="middle" x="304" y="-87.67" font-family="Times,serif" font-size="14.00">of the ephemeral key</text>
</g>
<!-- PrivKey&#45;&gt;PubKey -->
<g id="edge8" class="edge">
<title>PrivKey&#45;&gt;PubKey</title>
<path fill="none" stroke="black" d="M290.6,-161.76C292.36,-153.62 294.34,-144.48 296.22,-135.77"/>
<polygon fill="black" stroke="black" points="299.68,-136.35 298.38,-125.84 292.84,-134.87 299.68,-136.35"/>
</g>
<!-- RP_ID -->
<g id="node6" class="node">
<title>RP_ID</title>
<ellipse fill="none" stroke="black" cx="498" cy="-341.48" rx="37.89" ry="18"/>
<text text-anchor="middle" x="498" y="-337.78" font-family="Times,serif" font-size="14.00">RP ID</text>
</g>
<!-- RP_ID&#45;&gt;KDF -->
<g id="edge3" class="edge">
<title>RP_ID&#45;&gt;KDF</title>
<path fill="none" stroke="black" d="M466.72,-331.16C459.82,-328.58 452.66,-325.83 446,-323.48 412.86,-311.78 375.62,-300.02 345.25,-290.56"/>
<polygon fill="black" stroke="black" points="346.24,-287.2 335.65,-287.57 344.16,-293.88 346.24,-287.2"/>
</g>
<!-- RP_ID&#45;&gt;KDF -->
<g id="edge16" class="edge">
<title>RP_ID&#45;&gt;KDF</title>
<path fill="none" stroke="#ffe0e0" d="M474.18,-327.23C470.79,-325.93 467.33,-324.66 464,-323.48 430.71,-311.73 393.3,-299.92 361.26,-290.44"/>
<polygon fill="#ffe0e0" stroke="#ffe0e0" points="362.08,-287.03 351.5,-287.57 360.11,-293.75 362.08,-287.03"/>
</g>
<!-- Cred_ID&#45;&gt;crypt -->
<g id="edge14" class="edge">
<title>Cred_ID&#45;&gt;crypt</title>
<path fill="none" stroke="#ffe0e0" d="M103.14,-116.84C107.08,-128.87 110.93,-145.31 113.23,-159.31"/>
<polygon fill="#ffe0e0" stroke="#ffe0e0" points="109.79,-160.02 114.66,-169.43 116.73,-159.04 109.79,-160.02"/>
</g>
<!-- RP_DB -->
<g id="node10" class="node">
<title>RP_DB</title>
<path fill="none" stroke="black" d="M358,-32.73C358,-34.53 333.8,-36 304,-36 274.2,-36 250,-34.53 250,-32.73 250,-32.73 250,-3.27 250,-3.27 250,-1.47 274.2,0 304,0 333.8,0 358,-1.47 358,-3.27 358,-3.27 358,-32.73 358,-32.73"/>
<path fill="none" stroke="black" d="M358,-32.73C358,-30.92 333.8,-29.45 304,-29.45 274.2,-29.45 250,-30.92 250,-32.73"/>
<text text-anchor="middle" x="304" y="-14.3" font-family="Times,serif" font-size="14.00">RP Database</text>
</g>
<!-- Cred_ID&#45;&gt;RP_DB -->
<g id="edge9" class="edge">
<title>Cred_ID&#45;&gt;RP_DB</title>
<path fill="none" stroke="black" d="M128.56,-82.85C160.52,-70.25 208.48,-52.18 246.23,-38.47"/>
<polygon fill="black" stroke="black" points="247.87,-41.6 256.09,-34.91 245.5,-35.02 247.87,-41.6"/>
</g>
<!-- User_ID -->
<g id="node8" class="node">
<title>User_ID</title>
<ellipse fill="none" stroke="black" cx="487" cy="-98.87" rx="46.59" ry="18"/>
<text text-anchor="middle" x="487" y="-95.17" font-family="Times,serif" font-size="14.00">User ID</text>
</g>
<!-- User_ID&#45;&gt;RP_DB -->
<g id="edge10" class="edge">
<title>User_ID&#45;&gt;RP_DB</title>
<path fill="none" stroke="black" d="M453.6,-86.08C443.35,-81.59 432.2,-76.48 422,-72 397.12,-61.07 369.28,-49.38 346.8,-39.78"/>
<polygon fill="black" stroke="black" points="348.1,-36.52 337.53,-35.8 345.34,-42.96 348.1,-36.52"/>
</g>
<!-- User_ID&#45;&gt;RP_DB -->
<g id="edge12" class="edge">
<title>User_ID&#45;&gt;RP_DB</title>
<path fill="none" stroke="#ffe0e0" d="M464.12,-83.02C456.46,-79.36 447.94,-75.49 440,-72 414.22,-60.67 385.26,-48.54 360.64,-38.75"/>
<polygon fill="#ffe0e0" stroke="#ffe0e0" points="361.66,-35.39 351.08,-34.98 359.09,-41.9 361.66,-35.39"/>
</g>
<!-- PubKey&#45;&gt;RP_DB -->
<g id="edge11" class="edge">
<title>PubKey&#45;&gt;RP_DB</title>
<path fill="none" stroke="black" d="M304,-71.61C304,-63.51 304,-54.57 304,-46.39"/>
<polygon fill="black" stroke="black" points="307.5,-46.22 304,-36.22 300.5,-46.22 307.5,-46.22"/>
</g>
<!-- RP_DB&#45;&gt;Cred_ID -->
<g id="edge13" class="edge">
<title>RP_DB&#45;&gt;Cred_ID</title>
<path fill="none" stroke="#ffe0e0" d="M265.55,-35.55C231.88,-48.75 182.83,-67.19 145.74,-80.58"/>
<polygon fill="#ffe0e0" stroke="#ffe0e0" points="144.33,-77.37 136.1,-84.04 146.69,-83.95 144.33,-77.37"/>
</g>
</g>
</svg>
